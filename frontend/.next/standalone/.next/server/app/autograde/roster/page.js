(()=>{var e={};e.id=549,e.ids=[549],e.modules={72934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},55403:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external")},54580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},94749:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external")},45869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},20399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},39491:e=>{"use strict";e.exports=require("assert")},6113:e=>{"use strict";e.exports=require("crypto")},82361:e=>{"use strict";e.exports=require("events")},57147:e=>{"use strict";e.exports=require("fs")},13685:e=>{"use strict";e.exports=require("http")},95687:e=>{"use strict";e.exports=require("https")},22037:e=>{"use strict";e.exports=require("os")},71017:e=>{"use strict";e.exports=require("path")},12781:e=>{"use strict";e.exports=require("stream")},76224:e=>{"use strict";e.exports=require("tty")},57310:e=>{"use strict";e.exports=require("url")},73837:e=>{"use strict";e.exports=require("util")},59796:e=>{"use strict";e.exports=require("zlib")},21143:(e,t,s)=>{"use strict";s.r(t),s.d(t,{GlobalError:()=>d.a,__next_app__:()=>m,originalPathname:()=>u,pages:()=>c,routeModule:()=>x,tree:()=>o});var a=s(67096),r=s(16132),l=s(37284),d=s.n(l),n=s(32564),i={};for(let e in n)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(i[e]=()=>n[e]);s.d(t,i);let o=["",{children:["autograde",{children:["roster",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(s.bind(s,55464)),"/home/ubuntu/AutoGradeWeb/frontend/app/autograde/roster/page.tsx"]}]},{}]},{}]},{layout:[()=>Promise.resolve().then(s.bind(s,17897)),"/home/ubuntu/AutoGradeWeb/frontend/app/layout.tsx"],"not-found":[()=>Promise.resolve().then(s.t.bind(s,9291,23)),"next/dist/client/components/not-found-error"]}],c=["/home/ubuntu/AutoGradeWeb/frontend/app/autograde/roster/page.tsx"],u="/autograde/roster/page",m={require:s,loadChunk:()=>Promise.resolve()},x=new a.AppPageRouteModule({definition:{kind:r.x.APP_PAGE,page:"/autograde/roster/page",pathname:"/autograde/roster",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:o}})},72109:(e,t,s)=>{Promise.resolve().then(s.bind(s,52345))},52345:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>RosterPage});var a=s(30784),r=s(9885),l=s(57114),d=s(77694),n=s(19177);function CSVUploader({periodId:e,onSuccess:t,onCancel:s}){let[l,d]=(0,r.useState)(null),[i,o]=(0,r.useState)(null),[c,u]=(0,r.useState)({}),[m,x]=(0,r.useState)(!1),[p,h]=(0,r.useState)("upload"),handleFileSelect=async e=>{let t=e.target.files?.[0];if(!t)return;d(t),x(!0);let s=new FormData;s.append("file",t);try{let e=await n.Z.post("/api/upload/roster/preview",s);o(e.data.preview),u(e.data.preview.suggestions),h("map")}catch(e){alert("Failed to parse CSV file")}finally{x(!1)}},handleProcess=async()=>{if(!l||(c.studentId,0)){alert("Please map the Student ID column");return}x(!0);let s=new FormData;s.append("file",l),s.append("periodId",e),s.append("mapping",JSON.stringify(c));try{let e=await n.Z.post("/api/upload/roster/process",s);alert(`Success! ${e.data.inserted} students added, ${e.data.skipped} duplicates skipped.`),t()}catch(e){alert(e.response?.data?.error||"Failed to process roster")}finally{x(!1)}},updateMapping=(e,t)=>{u({...c,[e]:t})};return"upload"===p?(0,a.jsxs)("div",{className:"p-6",children:[a.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Upload Student Roster"}),(0,a.jsxs)("div",{className:"border-2 border-dashed border-gray-300 rounded-lg p-8 text-center",children:[a.jsx("input",{type:"file",accept:".csv",onChange:handleFileSelect,className:"hidden",id:"csv-upload",disabled:m}),(0,a.jsxs)("label",{htmlFor:"csv-upload",className:"cursor-pointer",children:[a.jsx("svg",{className:"mx-auto h-12 w-12 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M15 13l-3-3m0 0l-3 3m3-3v12"})}),(0,a.jsxs)("p",{className:"mt-2 text-sm text-gray-600",children:[a.jsx("span",{className:"font-semibold",children:"Click to upload"})," or drag and drop"]}),a.jsx("p",{className:"text-xs text-gray-500",children:"CSV files only"})]})]}),a.jsx("button",{onClick:s,className:"mt-4 w-full px-4 py-2 text-gray-600 hover:text-gray-800",children:"Cancel"})]}):"map"===p&&i?(0,a.jsxs)("div",{className:"p-6 max-h-[80vh] overflow-y-auto",children:[a.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Map CSV Columns"}),a.jsx("p",{className:"text-sm text-gray-600 mb-4",children:"Please confirm or adjust the column mappings below:"}),(0,a.jsxs)("div",{className:"space-y-4 mb-6",children:[(0,a.jsxs)("div",{children:[(0,a.jsxs)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Student ID Column ",a.jsx("span",{className:"text-red-500",children:"*"})]}),(0,a.jsxs)("select",{value:c.studentId??"",onChange:e=>updateMapping("studentId",e.target.value?parseInt(e.target.value):void 0),className:"w-full px-3 py-2 border border-gray-300 rounded-md",children:[a.jsx("option",{value:"",children:"Select column..."}),i.headers.map((e,t)=>(0,a.jsxs)("option",{value:t,children:[e," (Column ",t+1,")"]},t))]})]}),(0,a.jsxs)("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Name Format"}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsxs)("label",{className:"flex items-center",children:[a.jsx("input",{type:"radio",checked:void 0!==c.fullName,onChange:()=>{let e={...c};delete e.firstName,delete e.lastName,u(e)},className:"mr-2"}),a.jsx("span",{className:"text-sm",children:'Single "Full Name" column'})]}),(0,a.jsxs)("label",{className:"flex items-center",children:[a.jsx("input",{type:"radio",checked:void 0===c.fullName,onChange:()=>{let e={...c};delete e.fullName,u(e)},className:"mr-2"}),a.jsx("span",{className:"text-sm",children:"Separate First/Last name columns"})]})]})]}),void 0!==c.fullName?(0,a.jsxs)("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Full Name Column"}),(0,a.jsxs)("select",{value:c.fullName??"",onChange:e=>updateMapping("fullName",e.target.value?parseInt(e.target.value):void 0),className:"w-full px-3 py-2 border border-gray-300 rounded-md",children:[a.jsx("option",{value:"",children:"Select column..."}),i.headers.map((e,t)=>(0,a.jsxs)("option",{value:t,children:[e," (Column ",t+1,")"]},t))]})]}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"First Name Column"}),(0,a.jsxs)("select",{value:c.firstName??"",onChange:e=>updateMapping("firstName",e.target.value?parseInt(e.target.value):void 0),className:"w-full px-3 py-2 border border-gray-300 rounded-md",children:[a.jsx("option",{value:"",children:"Select column..."}),i.headers.map((e,t)=>(0,a.jsxs)("option",{value:t,children:[e," (Column ",t+1,")"]},t))]})]}),(0,a.jsxs)("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Last Name Column"}),(0,a.jsxs)("select",{value:c.lastName??"",onChange:e=>updateMapping("lastName",e.target.value?parseInt(e.target.value):void 0),className:"w-full px-3 py-2 border border-gray-300 rounded-md",children:[a.jsx("option",{value:"",children:"Select column..."}),i.headers.map((e,t)=>(0,a.jsxs)("option",{value:t,children:[e," (Column ",t+1,")"]},t))]})]})]}),(0,a.jsxs)("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Email Column (Optional)"}),(0,a.jsxs)("select",{value:c.email??"",onChange:e=>updateMapping("email",e.target.value?parseInt(e.target.value):void 0),className:"w-full px-3 py-2 border border-gray-300 rounded-md",children:[a.jsx("option",{value:"",children:"Select column..."}),i.headers.map((e,t)=>(0,a.jsxs)("option",{value:t,children:[e," (Column ",t+1,")"]},t))]})]})]}),(0,a.jsxs)("div",{className:"mb-4",children:[a.jsx("h4",{className:"font-medium mb-2",children:"Preview (First 5 rows)"}),a.jsx("div",{className:"overflow-x-auto",children:(0,a.jsxs)("table",{className:"min-w-full divide-y divide-gray-200 text-sm",children:[a.jsx("thead",{className:"bg-gray-50",children:a.jsx("tr",{children:i.headers.map((e,t)=>a.jsx("th",{className:"px-3 py-2 text-left text-xs font-medium text-gray-500 uppercase",children:e},t))})}),a.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:i.rows.map((e,t)=>a.jsx("tr",{children:e.map((e,t)=>a.jsx("td",{className:"px-3 py-2 whitespace-nowrap",children:e},t))},t))})]})})]}),(0,a.jsxs)("div",{className:"flex space-x-3",children:[a.jsx("button",{onClick:handleProcess,disabled:m||void 0===c.studentId,className:`flex-1 px-4 py-2 rounded-md font-medium ${m||void 0===c.studentId?"bg-gray-200 text-gray-400 cursor-not-allowed":"bg-blue-600 text-white hover:bg-blue-700"}`,children:m?"Processing...":"Import Students"}),a.jsx("button",{onClick:s,className:"px-4 py-2 text-gray-600 hover:text-gray-800",children:"Cancel"})]})]}):null}function CreatePeriodDialog({onSuccess:e,onCancel:t}){let[s,l]=(0,r.useState)(""),[d,i]=(0,r.useState)(""),[o,c]=(0,r.useState)(!1),[u,m]=(0,r.useState)(""),handleSubmit=async t=>{t.preventDefault(),m("");let a=parseInt(d);if(!a||a<1||a>10){m("Period number must be between 1 and 10");return}c(!0);try{await n.Z.post("/api/periods",{name:s||`Period ${a}`,periodNumber:a}),e()}catch(e){m(e.response?.data?.error||"Failed to create period")}finally{c(!1)}};return a.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:(0,a.jsxs)("div",{className:"bg-white rounded-lg shadow-xl max-w-md w-full p-6",children:[a.jsx("h2",{className:"text-xl font-semibold mb-4",children:"Create New Period"}),(0,a.jsxs)("form",{onSubmit:handleSubmit,className:"space-y-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsxs)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Period Number ",a.jsx("span",{className:"text-red-500",children:"*"})]}),a.jsx("input",{type:"number",value:d,onChange:e=>i(e.target.value),min:"1",max:"10",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"e.g., 1",required:!0})]}),(0,a.jsxs)("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Period Name (Optional)"}),a.jsx("input",{type:"text",value:s,onChange:e=>l(e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"e.g., Period 1 - Math"}),a.jsx("p",{className:"text-xs text-gray-500 mt-1",children:'Leave blank to use default "Period X" format'})]}),u&&a.jsx("p",{className:"text-sm text-red-600",children:u}),(0,a.jsxs)("div",{className:"flex space-x-3 pt-4",children:[a.jsx("button",{type:"submit",disabled:o||!d,className:`flex-1 px-4 py-2 rounded-md font-medium ${o||!d?"bg-gray-200 text-gray-400 cursor-not-allowed":"bg-blue-600 text-white hover:bg-blue-700"}`,children:o?"Creating...":"Create Period"}),a.jsx("button",{type:"button",onClick:t,className:"px-4 py-2 text-gray-600 hover:text-gray-800",children:"Cancel"})]})]})]})})}function RosterPage(){let e=(0,l.useRouter)(),[t,s]=(0,r.useState)(!1),[i,o]=(0,r.useState)(!1),[c,u]=(0,r.useState)(""),{data:m,loading:x,error:p,refetch:h}=(0,d.h)("/api/periods"),handleUploadClick=e=>{u(e),s(!0)},deletePeriod=async(e,t)=>{if(confirm(`Are you sure you want to delete ${t}? This will also remove all students in this period.`))try{await n.Z.delete(`/api/periods/${e}`),h()}catch(e){alert(e.response?.data?.error||"Failed to delete period")}};return(0,a.jsxs)("div",{className:"min-h-screen bg-gray-50",children:[a.jsx("div",{className:"bg-white shadow",children:(0,a.jsxs)("div",{className:"max-w-7xl mx-auto px-4 py-4",children:[a.jsx("button",{onClick:()=>e.push("/autograde"),className:"text-blue-600 hover:text-blue-800 mb-4",children:"← Back to Dashboard"}),a.jsx("h1",{className:"text-2xl font-bold",children:"Manage Class Rosters"})]})}),(0,a.jsxs)("div",{className:"max-w-7xl mx-auto px-4 py-8",children:[t&&a.jsx(CSVUploader,{periodId:c,onSuccess:()=>{s(!1),u(""),h()},onCancel:()=>s(!1)}),i&&a.jsx(CreatePeriodDialog,{onSuccess:()=>{o(!1),h()},onCancel:()=>o(!1)}),(0,a.jsxs)("div",{className:"bg-white rounded-lg shadow",children:[(0,a.jsxs)("div",{className:"px-6 py-4 border-b flex justify-between items-center",children:[a.jsx("h2",{className:"text-xl font-semibold",children:"Class Periods"}),a.jsx("button",{onClick:()=>o(!0),className:"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700",children:"Add Period"})]}),a.jsx("div",{className:"divide-y",children:x?a.jsx("div",{className:"px-6 py-8 text-center",children:"Loading..."}):p?(0,a.jsxs)("div",{className:"px-6 py-8 text-center text-red-600",children:["Error: ",p]}):m?.length===0?(0,a.jsxs)("div",{className:"px-6 py-8 text-center text-gray-500",children:[a.jsx("p",{className:"mb-4",children:"No periods created yet."}),a.jsx("button",{onClick:()=>o(!0),className:"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700",children:"Create Your First Period"})]}):m?.map(t=>a.jsx("div",{className:"px-6 py-4 hover:bg-gray-50",children:a.jsxs("div",{className:"flex justify-between items-center",children:[a.jsxs("div",{children:[a.jsx("h3",{className:"font-medium text-lg",children:t.name}),a.jsxs("p",{className:"text-sm text-gray-600",children:[t.studentCount," ",1===t.studentCount?"student":"students"]})]}),a.jsxs("div",{className:"flex items-center space-x-3",children:[a.jsx("button",{onClick:()=>handleUploadClick(t._id),className:"px-3 py-1 bg-green-100 text-green-700 rounded-md hover:bg-green-200 text-sm",children:"Upload CSV"}),a.jsx("button",{onClick:()=>e.push(`/autograde/roster/${t._id}`),className:"px-3 py-1 bg-blue-100 text-blue-700 rounded-md hover:bg-blue-200 text-sm",children:"View Students"}),a.jsx("button",{onClick:()=>deletePeriod(t._id,t.name),className:"px-3 py-1 bg-red-100 text-red-700 rounded-md hover:bg-red-200 text-sm",children:"Delete"})]})]})},t._id))})]}),(0,a.jsxs)("div",{className:"mt-8 bg-blue-50 rounded-lg p-6",children:[a.jsx("h3",{className:"font-semibold text-blue-900 mb-2",children:"Getting Started"}),(0,a.jsxs)("ol",{className:"list-decimal list-inside text-blue-800 text-sm space-y-2",children:[a.jsx("li",{children:"Create periods for each of your classes (e.g., Period 1, Period 2)"}),a.jsx("li",{children:"Upload a CSV file with student information for each period"}),a.jsx("li",{children:"The system will automatically detect student IDs and names from your CSV"}),a.jsx("li",{children:"You can then generate grade sheets for assignments"})]})]}),(0,a.jsxs)("div",{className:"mt-4 bg-gray-50 rounded-lg p-6",children:[a.jsx("h3",{className:"font-semibold text-gray-900 mb-2",children:"CSV File Format"}),a.jsx("p",{className:"text-gray-700 text-sm mb-3",children:"Your CSV file should have columns for:"}),(0,a.jsxs)("ul",{className:"list-disc list-inside text-gray-700 text-sm space-y-1",children:[(0,a.jsxs)("li",{children:[a.jsx("strong",{children:"Student ID"})," - Unique identifier (required)"]}),(0,a.jsxs)("li",{children:[a.jsx("strong",{children:"Name"}),' - Either "First Name" & "Last Name" or single "Name" column']}),(0,a.jsxs)("li",{children:[a.jsx("strong",{children:"Email"})," - Student email (optional)"]})]}),a.jsx("div",{className:"mt-3 bg-white p-3 rounded border border-gray-200",children:(0,a.jsxs)("p",{className:"text-xs font-mono text-gray-600",children:["Example:",a.jsx("br",{}),"Student ID,First Name,Last Name,Email",a.jsx("br",{}),"12345,John,Smith,john.smith@school.edu",a.jsx("br",{}),"12346,Jane,Doe,jane.doe@school.edu"]})})]})]})]})}},55464:(e,t,s)=>{"use strict";s.r(t),s.d(t,{$$typeof:()=>d,__esModule:()=>l,default:()=>i});var a=s(95153);let r=(0,a.createProxy)(String.raw`/home/ubuntu/AutoGradeWeb/frontend/app/autograde/roster/page.tsx`),{__esModule:l,$$typeof:d}=r,n=r.default,i=n}};var t=require("../../../webpack-runtime.js");t.C(e);var __webpack_exec__=e=>t(t.s=e),s=t.X(0,[657,12,145,622,177,694],()=>__webpack_exec__(21143));module.exports=s})();